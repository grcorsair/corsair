{
  "providerId": "azure-entra",
  "providerName": "Azure Entra ID",
  "version": "0.1.0",
  "description": "Corsair plugin for Azure Entra ID (formerly Azure AD) - skeleton plugin demonstrating extensibility",
  "attackVectors": [
    {
      "id": "conditional-access-bypass",
      "name": "Conditional Access Bypass",
      "description": "Tests conditional access policy enforcement by simulating access from untrusted locations",
      "severity": "CRITICAL",
      "mitreMapping": ["T1078.004"],
      "preconditions": ["Conditional access policies are missing or misconfigured"],
      "remediations": ["Enable conditional access policies", "Require MFA from untrusted locations"]
    },
    {
      "id": "password-sync-exploit",
      "name": "Password Sync Exploit",
      "description": "Tests password hash synchronization security between on-premises AD and Entra ID",
      "severity": "HIGH",
      "mitreMapping": ["T1110"],
      "preconditions": ["Password hash sync enabled without additional controls"],
      "remediations": ["Enable password writeback", "Configure smart lockout"]
    },
    {
      "id": "mfa-fatigue",
      "name": "MFA Fatigue",
      "description": "Tests resilience against MFA fatigue attacks by analyzing number matching and push notification settings",
      "severity": "HIGH",
      "mitreMapping": ["T1621"],
      "preconditions": ["MFA push without number matching enabled"],
      "remediations": ["Enable number matching for MFA push", "Configure fraud alerts"]
    }
  ],
  "capabilities": {
    "recon": true,
    "raid": false,
    "escape": false,
    "realTimeAPI": false
  },
  "requiredPermissions": [
    "Directory.Read.All",
    "Policy.Read.All",
    "SecurityEvents.Read.All"
  ],
  "frameworkMappings": {
    "drift": {
      "conditionalAccessPolicies": {
        "mitre": "T1078.004",
        "mitreName": "Cloud Accounts",
        "controls": {
          "NIST-800-53": [{"controlId": "AC-2", "controlName": "Account Management"}, {"controlId": "AC-3", "controlName": "Access Enforcement"}],
          "NIST-CSF": [{"controlId": "PR.AC-4", "controlName": "Access permissions and authorizations"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "ISO27001": [{"controlId": "A.9.4.1", "controlName": "Information access restriction"}]
        },
        "nist": "PR.AC-4",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Missing conditional access policies allow unauthorized cloud access"
      },
      "passwordHashSync": {
        "mitre": "T1110",
        "mitreName": "Brute Force",
        "controls": {
          "NIST-800-53": [{"controlId": "IA-5", "controlName": "Authenticator Management"}],
          "NIST-CSF": [{"controlId": "PR.AC-1", "controlName": "Identity and credential management"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}]
        },
        "nist": "PR.AC-1",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Insecure password sync exposes credentials to brute force"
      },
      "mfaConfiguration": {
        "mitre": "T1621",
        "mitreName": "Multi-Factor Authentication Request Generation",
        "controls": {
          "NIST-800-53": [{"controlId": "IA-2", "controlName": "Identification and Authentication"}],
          "NIST-CSF": [{"controlId": "PR.AC-7", "controlName": "Authentication mechanisms"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}]
        },
        "nist": "PR.AC-7",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "MFA without number matching vulnerable to fatigue attacks"
      }
    },
    "attackVectors": {
      "conditional-access-bypass": {
        "mitre": "T1078.004",
        "mitreName": "Cloud Accounts",
        "nist": "PR.AC-4",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Conditional access bypass exploits missing or weak access policies"
      },
      "password-sync-exploit": {
        "mitre": "T1110",
        "mitreName": "Brute Force",
        "nist": "PR.AC-1",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Password sync exploit targets insecure hash synchronization"
      },
      "mfa-fatigue": {
        "mitre": "T1621",
        "mitreName": "Multi-Factor Authentication Request Generation",
        "nist": "PR.AC-7",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "MFA fatigue attack exploits push notification without number matching"
      }
    }
  }
}
