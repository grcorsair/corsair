{
  "providerId": "aws-iam",
  "providerName": "AWS IAM",
  "version": "1.0.0",
  "description": "Corsair plugin for AWS IAM - enables chaos engineering and security testing of IAM configurations, policies, and credential hygiene",
  "attackVectors": [
    {
      "id": "overprivileged-role",
      "name": "Overprivileged Role",
      "description": "Tests for IAM roles and policies with excessive permissions that enable lateral movement and privilege escalation",
      "severity": "CRITICAL",
      "mitreMapping": ["T1078.004"],
      "preconditions": ["IAM policies with wildcard actions or resources"],
      "remediations": ["Apply least-privilege policies", "Use IAM Access Analyzer to identify overprivileged roles"]
    },
    {
      "id": "unused-credentials",
      "name": "Unused Credentials",
      "description": "Tests for unused IAM credentials (access keys, passwords) that increase the attack surface",
      "severity": "HIGH",
      "mitreMapping": ["T1078"],
      "preconditions": ["IAM users with credentials unused for 90+ days"],
      "remediations": ["Disable or delete unused credentials", "Implement credential rotation policy"]
    },
    {
      "id": "missing-mfa",
      "name": "Missing MFA",
      "description": "Tests for IAM users and root account without multi-factor authentication enabled",
      "severity": "CRITICAL",
      "mitreMapping": ["T1556"],
      "preconditions": ["MFA not enabled for IAM users or root account"],
      "remediations": ["Enable MFA for all IAM users", "Enable MFA for root account", "Use hardware MFA for root"]
    },
    {
      "id": "policy-escalation",
      "name": "Policy Escalation",
      "description": "Tests for IAM policies that allow privilege escalation through policy attachment or role assumption",
      "severity": "HIGH",
      "mitreMapping": ["T1548"],
      "preconditions": ["IAM policies allowing iam:AttachUserPolicy, iam:PutRolePolicy, or sts:AssumeRole"],
      "remediations": ["Restrict policy management permissions", "Implement permissions boundaries", "Use SCPs to limit escalation paths"]
    }
  ],
  "capabilities": {
    "recon": true,
    "raid": true,
    "escape": true,
    "realTimeAPI": false
  },
  "requiredPermissions": [
    "iam:GetCredentialReport",
    "iam:ListUsers",
    "iam:ListRoles",
    "iam:ListPolicies",
    "iam:ListAccessKeys",
    "iam:GetAccountSummary",
    "iam:GetLoginProfile",
    "iam:ListMFADevices"
  ],
  "documentation": {
    "readme": "README.md",
    "examples": "examples/",
    "api": "docs/api.md"
  },
  "frameworkMappings": {
    "drift": {
      "mfaEnabled": {
        "mitre": "T1556",
        "mitreName": "Modify Authentication Process",
        "controls": {
          "NIST-800-53": [{"controlId": "IA-2", "controlName": "Identification and Authentication"}, {"controlId": "IA-5", "controlName": "Authenticator Management"}],
          "NIST-CSF": [{"controlId": "PR.AC-7", "controlName": "Authentication mechanisms"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "CIS": [{"controlId": "1.10", "controlName": "Ensure MFA is enabled for all IAM users"}],
          "ISO27001": [{"controlId": "A.9.4.2", "controlName": "Secure log-on procedures"}],
          "PCI-DSS": [{"controlId": "8.3.1", "controlName": "Multi-factor authentication"}]
        },
        "nist": "PR.AC-7",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "MFA not enabled for IAM users allows credential-only authentication"
      },
      "hasOverprivilegedPolicies": {
        "mitre": "T1078.004",
        "mitreName": "Cloud Accounts",
        "controls": {
          "NIST-800-53": [{"controlId": "AC-6", "controlName": "Least Privilege"}, {"controlId": "AC-2", "controlName": "Account Management"}],
          "NIST-CSF": [{"controlId": "PR.AC-4", "controlName": "Access permissions and authorizations"}],
          "SOC2": [{"controlId": "CC6.3", "controlName": "Role-based access control"}],
          "CIS": [{"controlId": "1.16", "controlName": "Ensure IAM policies that allow full admin privileges are not attached"}],
          "ISO27001": [{"controlId": "A.9.2.3", "controlName": "Management of privileged access rights"}],
          "PCI-DSS": [{"controlId": "7.1", "controlName": "Limit access to system components"}]
        },
        "nist": "PR.AC-4",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.3",
        "soc2Description": "Role-based access control",
        "description": "Overprivileged IAM policies violate least privilege and enable lateral movement"
      },
      "unusedCredentialsExist": {
        "mitre": "T1078",
        "mitreName": "Valid Accounts",
        "controls": {
          "NIST-800-53": [{"controlId": "AC-2", "controlName": "Account Management"}, {"controlId": "IA-4", "controlName": "Identifier Management"}],
          "NIST-CSF": [{"controlId": "PR.AC-1", "controlName": "Identity and credential management"}],
          "SOC2": [{"controlId": "CC6.2", "controlName": "Registration and authorization"}],
          "CIS": [{"controlId": "1.12", "controlName": "Ensure credentials unused for 45 days or greater are disabled"}],
          "ISO27001": [{"controlId": "A.9.2.6", "controlName": "Removal or adjustment of access rights"}],
          "PCI-DSS": [{"controlId": "8.1.4", "controlName": "Remove/disable inactive user accounts"}]
        },
        "nist": "PR.AC-1",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.2",
        "soc2Description": "Registration and authorization",
        "description": "Unused credentials increase attack surface for credential theft"
      },
      "accessKeysRotated": {
        "mitre": "T1098",
        "mitreName": "Account Manipulation",
        "controls": {
          "NIST-800-53": [{"controlId": "IA-5", "controlName": "Authenticator Management"}],
          "NIST-CSF": [{"controlId": "PR.AC-1", "controlName": "Identity and credential management"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "CIS": [{"controlId": "1.14", "controlName": "Ensure access keys are rotated every 90 days or less"}],
          "ISO27001": [{"controlId": "A.9.2.4", "controlName": "Management of secret authentication information"}],
          "PCI-DSS": [{"controlId": "8.2.4", "controlName": "Change user passwords at least once every 90 days"}]
        },
        "nist": "PR.AC-1",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Stale access keys are more likely to be compromised over time"
      },
      "rootAccountMfaEnabled": {
        "mitre": "T1548",
        "mitreName": "Abuse Elevation Control Mechanism",
        "controls": {
          "NIST-800-53": [{"controlId": "IA-2", "controlName": "Identification and Authentication"}, {"controlId": "AC-6", "controlName": "Least Privilege"}],
          "NIST-CSF": [{"controlId": "PR.AC-7", "controlName": "Authentication mechanisms"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "CIS": [{"controlId": "1.5", "controlName": "Ensure MFA is enabled for the root user account"}],
          "ISO27001": [{"controlId": "A.9.4.2", "controlName": "Secure log-on procedures"}],
          "PCI-DSS": [{"controlId": "8.3.1", "controlName": "Multi-factor authentication"}]
        },
        "nist": "PR.AC-7",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Root account without MFA is the highest-impact compromise vector"
      }
    },
    "attackVectors": {
      "overprivileged-role": {
        "mitre": "T1078.004",
        "mitreName": "Cloud Accounts",
        "nist": "PR.AC-4",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.3",
        "soc2Description": "Role-based access control",
        "description": "Overprivileged role test exploits excessive IAM permissions"
      },
      "unused-credentials": {
        "mitre": "T1078",
        "mitreName": "Valid Accounts",
        "nist": "PR.AC-1",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.2",
        "soc2Description": "Registration and authorization",
        "description": "Unused credentials test identifies stale accounts that increase attack surface"
      },
      "missing-mfa": {
        "mitre": "T1556",
        "mitreName": "Modify Authentication Process",
        "nist": "PR.AC-7",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Missing MFA test identifies accounts without multi-factor authentication"
      },
      "policy-escalation": {
        "mitre": "T1548",
        "mitreName": "Abuse Elevation Control Mechanism",
        "nist": "PR.AC-4",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.3",
        "soc2Description": "Role-based access control",
        "description": "Policy escalation test identifies paths for privilege escalation via IAM policies"
      }
    }
  }
}
