{
  "providerId": "aws-s3",
  "providerName": "AWS S3",
  "version": "1.0.0",
  "description": "Corsair plugin for AWS S3 Buckets - enables chaos engineering and security testing of S3 storage configurations",
  "attackVectors": [
    {
      "id": "public-access-test",
      "name": "Public Access Test",
      "description": "Tests S3 bucket public access block configuration to identify publicly accessible buckets",
      "severity": "CRITICAL",
      "mitreMapping": ["T1530"],
      "preconditions": ["Public access block is disabled"],
      "remediations": ["Enable S3 Block Public Access at bucket level", "Enable S3 Block Public Access at account level"]
    },
    {
      "id": "encryption-test",
      "name": "Encryption Test",
      "description": "Tests S3 bucket encryption configuration to identify unencrypted data at rest",
      "severity": "HIGH",
      "mitreMapping": ["T1530"],
      "preconditions": ["Server-side encryption is not configured"],
      "remediations": ["Enable AES-256 or AWS KMS encryption", "Configure default bucket encryption"]
    },
    {
      "id": "versioning-test",
      "name": "Versioning Test",
      "description": "Tests S3 bucket versioning to identify data protection gaps",
      "severity": "MEDIUM",
      "mitreMapping": ["T1485"],
      "preconditions": ["Versioning is disabled"],
      "remediations": ["Enable bucket versioning", "Consider S3 Object Lock for immutable backups"]
    }
  ],
  "capabilities": {
    "recon": true,
    "raid": true,
    "escape": true,
    "realTimeAPI": false
  },
  "requiredPermissions": [
    "s3:GetBucketPublicAccessBlock",
    "s3:GetBucketEncryption",
    "s3:GetBucketVersioning",
    "s3:GetBucketLogging"
  ],
  "frameworkMappings": {
    "drift": {
      "publicAccessBlock": {
        "mitre": "T1530",
        "mitreName": "Data from Cloud Storage Object",
        "controls": {
          "NIST-800-53": [{"controlId": "AC-3", "controlName": "Access Enforcement"}, {"controlId": "AC-4", "controlName": "Information Flow Enforcement"}],
          "NIST-CSF": [{"controlId": "PR.AC-4", "controlName": "Access permissions and authorizations"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "CIS": [{"controlId": "2.1.5", "controlName": "Ensure S3 bucket access is restricted"}],
          "ISO27001": [{"controlId": "A.9.1.2", "controlName": "Access to networks and network services"}],
          "PCI-DSS": [{"controlId": "1.3.6", "controlName": "Restrict inbound and outbound traffic"}]
        },
        "nist": "PR.AC-4",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Public access block disabled exposes bucket data to unauthorized access"
      },
      "encryption": {
        "mitre": "T1530",
        "mitreName": "Data from Cloud Storage Object",
        "controls": {
          "NIST-800-53": [{"controlId": "SC-28", "controlName": "Protection of Information at Rest"}],
          "NIST-CSF": [{"controlId": "PR.DS-1", "controlName": "Data-at-rest is protected"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "CIS": [{"controlId": "2.1.1", "controlName": "Ensure S3 Bucket Encryption is enabled"}],
          "ISO27001": [{"controlId": "A.10.1.1", "controlName": "Policy on use of cryptographic controls"}],
          "PCI-DSS": [{"controlId": "3.4", "controlName": "Render PAN unreadable anywhere stored"}]
        },
        "nist": "PR.DS-1",
        "nistFunction": "Protect - Data Security",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Missing encryption exposes data at rest to unauthorized access"
      },
      "versioning": {
        "mitre": "T1485",
        "mitreName": "Data Destruction",
        "controls": {
          "NIST-800-53": [{"controlId": "CP-9", "controlName": "Information System Backup"}, {"controlId": "CP-10", "controlName": "Information System Recovery"}],
          "NIST-CSF": [{"controlId": "PR.IP-4", "controlName": "Backups of information are maintained"}],
          "SOC2": [{"controlId": "A1.2", "controlName": "Recovery time and point objectives"}],
          "CIS": [{"controlId": "2.1.3", "controlName": "Ensure S3 Versioning is enabled"}],
          "ISO27001": [{"controlId": "A.12.3.1", "controlName": "Information backup"}],
          "PCI-DSS": [{"controlId": "10.7", "controlName": "Retain audit trail history"}]
        },
        "nist": "PR.IP-4",
        "nistFunction": "Protect - Information Protection",
        "soc2": "A1.2",
        "soc2Description": "Recovery time and point objectives",
        "description": "Disabled versioning prevents recovery from data deletion or corruption"
      },
      "logging": {
        "mitre": "T1562",
        "mitreName": "Impair Defenses",
        "controls": {
          "NIST-800-53": [{"controlId": "SI-4", "controlName": "Information System Monitoring"}, {"controlId": "AU-2", "controlName": "Audit Events"}],
          "NIST-CSF": [{"controlId": "DE.CM-7", "controlName": "Monitoring for unauthorized activity"}],
          "SOC2": [{"controlId": "CC7.2", "controlName": "System monitoring"}],
          "ISO27001": [{"controlId": "A.12.4.1", "controlName": "Event logging"}]
        },
        "nist": "DE.CM-7",
        "nistFunction": "Detect - Continuous Monitoring",
        "soc2": "CC7.2",
        "soc2Description": "System monitoring",
        "description": "Disabled logging prevents detection of unauthorized access"
      }
    },
    "attackVectors": {
      "public-access-test": {
        "mitre": "T1530",
        "mitreName": "Data from Cloud Storage Object",
        "nist": "PR.AC-4",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Public access test exploits disabled public access blocks"
      },
      "encryption-test": {
        "mitre": "T1530",
        "mitreName": "Data from Cloud Storage Object",
        "nist": "PR.DS-1",
        "nistFunction": "Protect - Data Security",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Encryption test exploits missing server-side encryption"
      },
      "versioning-test": {
        "mitre": "T1485",
        "mitreName": "Data Destruction",
        "nist": "PR.IP-4",
        "nistFunction": "Protect - Information Protection",
        "soc2": "A1.2",
        "soc2Description": "Recovery time and point objectives",
        "description": "Versioning test exploits disabled bucket versioning"
      }
    }
  }
}
