{
  "providerId": "gitlab",
  "providerName": "GitLab",
  "version": "1.0.0",
  "description": "Corsair plugin for GitLab - enables chaos engineering and security testing of GitLab project configurations, CI/CD pipelines, and access controls",
  "attackVectors": [
    {
      "id": "unprotected-branch-push",
      "name": "Unprotected Branch Push",
      "description": "Tests for unprotected branches that allow direct push or force push, enabling supply chain tampering",
      "severity": "HIGH",
      "mitreMapping": ["T1195"],
      "preconditions": ["Branch protection disabled or force push allowed"],
      "remediations": ["Enable branch protection on default branch", "Disable force push", "Require code owner approval"]
    },
    {
      "id": "secret-exposure",
      "name": "Secret Exposure",
      "description": "Tests for exposed secrets in CI/CD variables, unmasked and unprotected pipeline variables",
      "severity": "CRITICAL",
      "mitreMapping": ["T1552"],
      "preconditions": ["CI/CD variables not masked or protected", "Secret detection not enabled"],
      "remediations": ["Enable secret detection in CI pipeline", "Mask all sensitive variables", "Mark variables as protected"]
    },
    {
      "id": "mfa-bypass",
      "name": "MFA Bypass",
      "description": "Tests for accounts without multi-factor authentication enforcement, enabling credential-only access",
      "severity": "CRITICAL",
      "mitreMapping": ["T1556"],
      "preconditions": ["MFA not enforced at group or instance level"],
      "remediations": ["Enforce MFA for all group members", "Require MFA at instance level"]
    },
    {
      "id": "ci-pipeline-injection",
      "name": "CI Pipeline Injection",
      "description": "Tests for CI/CD pipeline vulnerabilities including unverified SAST/DAST and container scanning gaps",
      "severity": "HIGH",
      "mitreMapping": ["T1195.002"],
      "preconditions": ["SAST or DAST not enabled", "Container scanning disabled"],
      "remediations": ["Enable SAST in .gitlab-ci.yml", "Enable DAST scanning", "Enable container scanning for Docker images"]
    },
    {
      "id": "token-abuse",
      "name": "Token Abuse",
      "description": "Tests for excessive or unrotated access tokens and deploy tokens that expand attack surface",
      "severity": "HIGH",
      "mitreMapping": ["T1078"],
      "preconditions": ["No token age policy", "Excessive access or deploy tokens"],
      "remediations": ["Set maximum token lifetime policy", "Audit and remove unused tokens", "Disable guest access"]
    }
  ],
  "capabilities": {
    "recon": true,
    "raid": true,
    "escape": true,
    "realTimeAPI": false
  },
  "requiredPermissions": [
    "read_api",
    "read_repository",
    "read_registry"
  ],
  "documentation": {
    "readme": "README.md",
    "examples": "examples/",
    "api": "docs/api.md"
  },
  "frameworkMappings": {
    "drift": {
      "visibility": {
        "mitre": "T1530",
        "mitreName": "Data from Cloud Storage",
        "controls": {
          "NIST-800-53": [{"controlId": "AC-3", "controlName": "Access Enforcement"}, {"controlId": "SC-7", "controlName": "Boundary Protection"}],
          "NIST-CSF": [{"controlId": "PR.AC-4", "controlName": "Access permissions and authorizations"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "CIS": [{"controlId": "1.1", "controlName": "Ensure project visibility is set to private"}],
          "ISO27001": [{"controlId": "A.9.1.2", "controlName": "Access to networks and network services"}],
          "PCI-DSS": [{"controlId": "7.1", "controlName": "Limit access to system components"}]
        },
        "nist": "PR.AC-4",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Public repository visibility exposes source code and secrets to unauthorized access"
      },
      "branchProtection.forcePushDisabled": {
        "mitre": "T1195",
        "mitreName": "Supply Chain Compromise",
        "controls": {
          "NIST-800-53": [{"controlId": "CM-3", "controlName": "Configuration Change Control"}, {"controlId": "SI-7", "controlName": "Software, Firmware, and Information Integrity"}],
          "NIST-CSF": [{"controlId": "PR.IP-1", "controlName": "Configuration management"}],
          "SOC2": [{"controlId": "CC8.1", "controlName": "Change management"}],
          "ISO27001": [{"controlId": "A.14.2.2", "controlName": "System change control procedures"}],
          "PCI-DSS": [{"controlId": "6.4.5", "controlName": "Change control procedures"}]
        },
        "nist": "PR.IP-1",
        "nistFunction": "Protect - Information Protection",
        "soc2": "CC8.1",
        "soc2Description": "Change management",
        "description": "Force push enabled allows history rewriting and supply chain tampering"
      },
      "branchProtection.requireApprovals": {
        "mitre": "T1195",
        "mitreName": "Supply Chain Compromise",
        "controls": {
          "NIST-800-53": [{"controlId": "CM-3", "controlName": "Configuration Change Control"}],
          "NIST-CSF": [{"controlId": "PR.IP-1", "controlName": "Configuration management"}],
          "SOC2": [{"controlId": "CC8.1", "controlName": "Change management"}],
          "ISO27001": [{"controlId": "A.14.2.2", "controlName": "System change control procedures"}],
          "PCI-DSS": [{"controlId": "6.3.2", "controlName": "Review of custom code"}]
        },
        "nist": "PR.IP-1",
        "nistFunction": "Protect - Information Protection",
        "soc2": "CC8.1",
        "soc2Description": "Change management",
        "description": "No merge request approvals allows unreviewed code to enter production"
      },
      "cicdSecurity.sastEnabled": {
        "mitre": "T1588",
        "mitreName": "Obtain Capabilities",
        "controls": {
          "NIST-800-53": [{"controlId": "SA-11", "controlName": "Developer Testing and Evaluation"}],
          "NIST-CSF": [{"controlId": "DE.CM-8", "controlName": "Vulnerability scans"}],
          "SOC2": [{"controlId": "CC7.1", "controlName": "Vulnerability management"}],
          "ISO27001": [{"controlId": "A.14.2.8", "controlName": "System security testing"}],
          "PCI-DSS": [{"controlId": "6.6", "controlName": "Address new threats and vulnerabilities"}]
        },
        "nist": "DE.CM-8",
        "nistFunction": "Detect - Continuous Monitoring",
        "soc2": "CC7.1",
        "soc2Description": "Vulnerability management",
        "description": "SAST not enabled means static code vulnerabilities go undetected"
      },
      "cicdSecurity.secretDetectionEnabled": {
        "mitre": "T1552",
        "mitreName": "Unsecured Credentials",
        "controls": {
          "NIST-800-53": [{"controlId": "IA-5", "controlName": "Authenticator Management"}, {"controlId": "SC-28", "controlName": "Protection of Information at Rest"}],
          "NIST-CSF": [{"controlId": "PR.AC-1", "controlName": "Identity and credential management"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "ISO27001": [{"controlId": "A.9.2.4", "controlName": "Management of secret authentication information"}],
          "PCI-DSS": [{"controlId": "8.2.1", "controlName": "Strong cryptography for credential storage"}]
        },
        "nist": "PR.AC-1",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Secret detection not enabled allows credentials to be committed to repositories"
      },
      "accessControl.mfaEnforced": {
        "mitre": "T1556",
        "mitreName": "Modify Authentication Process",
        "controls": {
          "NIST-800-53": [{"controlId": "IA-2", "controlName": "Identification and Authentication"}, {"controlId": "IA-5", "controlName": "Authenticator Management"}],
          "NIST-CSF": [{"controlId": "PR.AC-7", "controlName": "Authentication mechanisms"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "CIS": [{"controlId": "6.5", "controlName": "Require MFA for all users"}],
          "ISO27001": [{"controlId": "A.9.4.2", "controlName": "Secure log-on procedures"}],
          "PCI-DSS": [{"controlId": "8.3.1", "controlName": "Multi-factor authentication"}]
        },
        "nist": "PR.AC-7",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "MFA not enforced allows credential-only authentication to GitLab"
      },
      "accessControl.guestAccessEnabled": {
        "mitre": "T1078",
        "mitreName": "Valid Accounts",
        "controls": {
          "NIST-800-53": [{"controlId": "AC-6", "controlName": "Least Privilege"}, {"controlId": "AC-2", "controlName": "Account Management"}],
          "NIST-CSF": [{"controlId": "PR.AC-4", "controlName": "Access permissions and authorizations"}],
          "SOC2": [{"controlId": "CC6.3", "controlName": "Role-based access control"}],
          "ISO27001": [{"controlId": "A.9.2.3", "controlName": "Management of privileged access rights"}],
          "PCI-DSS": [{"controlId": "7.1.2", "controlName": "Restrict access to privileged user IDs"}]
        },
        "nist": "PR.AC-4",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.3",
        "soc2Description": "Role-based access control",
        "description": "Guest access enabled allows unauthorized users to view project resources"
      },
      "auditSettings.signedCommitsRequired": {
        "mitre": "T1565",
        "mitreName": "Data Manipulation",
        "controls": {
          "NIST-800-53": [{"controlId": "AU-10", "controlName": "Non-Repudiation"}, {"controlId": "SI-7", "controlName": "Software, Firmware, and Information Integrity"}],
          "NIST-CSF": [{"controlId": "PR.DS-6", "controlName": "Integrity checking mechanisms"}],
          "SOC2": [{"controlId": "CC7.2", "controlName": "Monitoring activities"}],
          "ISO27001": [{"controlId": "A.12.2.1", "controlName": "Controls against malware"}],
          "PCI-DSS": [{"controlId": "10.5", "controlName": "Secure audit trails"}]
        },
        "nist": "PR.DS-6",
        "nistFunction": "Protect - Data Security",
        "soc2": "CC7.2",
        "soc2Description": "Monitoring activities",
        "description": "Unsigned commits allow code authorship to be spoofed"
      }
    },
    "attackVectors": {
      "unprotected-branch-push": {
        "mitre": "T1195",
        "mitreName": "Supply Chain Compromise",
        "nist": "PR.IP-1",
        "nistFunction": "Protect - Information Protection",
        "soc2": "CC8.1",
        "soc2Description": "Change management",
        "description": "Unprotected branch push exploits missing branch protection to inject malicious code"
      },
      "secret-exposure": {
        "mitre": "T1552",
        "mitreName": "Unsecured Credentials",
        "nist": "PR.AC-1",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Secret exposure test identifies credentials and tokens committed to repositories"
      },
      "mfa-bypass": {
        "mitre": "T1556",
        "mitreName": "Modify Authentication Process",
        "nist": "PR.AC-7",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "MFA bypass test identifies accounts without multi-factor authentication"
      },
      "ci-pipeline-injection": {
        "mitre": "T1195.002",
        "mitreName": "Compromise Software Supply Chain",
        "nist": "PR.IP-1",
        "nistFunction": "Protect - Information Protection",
        "soc2": "CC8.1",
        "soc2Description": "Change management",
        "description": "CI pipeline injection test exploits gaps in SAST/DAST and container scanning"
      },
      "token-abuse": {
        "mitre": "T1078",
        "mitreName": "Valid Accounts",
        "nist": "PR.AC-1",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.2",
        "soc2Description": "Registration and authorization",
        "description": "Token abuse test identifies excessive and unrotated access tokens"
      }
    }
  }
}
