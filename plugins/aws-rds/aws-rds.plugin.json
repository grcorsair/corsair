{
  "providerId": "aws-rds",
  "providerName": "AWS RDS",
  "version": "1.0.0",
  "description": "Corsair plugin for AWS RDS - enables chaos engineering and security testing of RDS instance configurations, encryption, and access controls",
  "attackVectors": [
    {
      "id": "public-endpoint",
      "name": "Public Endpoint",
      "description": "Tests for RDS instances with publicly accessible endpoints that expose databases to internet-based attacks",
      "severity": "CRITICAL",
      "mitreMapping": ["T1190"],
      "preconditions": ["RDS instance with PubliclyAccessible set to true"],
      "remediations": ["Disable public accessibility", "Place RDS instances in private subnets", "Use VPC endpoints for access"]
    },
    {
      "id": "unencrypted-storage",
      "name": "Unencrypted Storage",
      "description": "Tests for RDS instances without storage encryption, allowing data extraction if physical access is obtained",
      "severity": "HIGH",
      "mitreMapping": ["T1530"],
      "preconditions": ["RDS instance with StorageEncrypted set to false"],
      "remediations": ["Enable storage encryption with KMS", "Migrate to encrypted instance if encryption cannot be enabled in place"]
    },
    {
      "id": "weak-auth",
      "name": "Weak Authentication",
      "description": "Tests for RDS instances using only password authentication without IAM database authentication",
      "severity": "HIGH",
      "mitreMapping": ["T1110"],
      "preconditions": ["RDS instance without IAM authentication enabled"],
      "remediations": ["Enable IAM database authentication", "Implement strong password policies", "Use SSL/TLS for connections"]
    },
    {
      "id": "no-audit-logging",
      "name": "No Audit Logging",
      "description": "Tests for RDS instances without audit logging, preventing detection and investigation of database breaches",
      "severity": "HIGH",
      "mitreMapping": ["T1562"],
      "preconditions": ["RDS instance without audit logging enabled"],
      "remediations": ["Enable audit logging", "Configure CloudWatch log exports", "Enable Performance Insights for query monitoring"]
    }
  ],
  "capabilities": {
    "recon": true,
    "raid": true,
    "escape": true,
    "realTimeAPI": false
  },
  "requiredPermissions": [
    "rds:DescribeDBInstances",
    "rds:DescribeDBClusters",
    "rds:DescribeDBSnapshotAttributes",
    "rds:DescribeEventSubscriptions",
    "rds:ListTagsForResource"
  ],
  "documentation": {
    "readme": "README.md",
    "examples": "examples/",
    "api": "docs/api.md"
  },
  "frameworkMappings": {
    "drift": {
      "publiclyAccessible": {
        "mitre": "T1190",
        "mitreName": "Exploit Public-Facing Application",
        "controls": {
          "NIST-800-53": [{"controlId": "SC-7", "controlName": "Boundary Protection"}, {"controlId": "AC-4", "controlName": "Information Flow Enforcement"}],
          "NIST-CSF": [{"controlId": "PR.AC-5", "controlName": "Network integrity is protected"}],
          "SOC2": [{"controlId": "CC6.6", "controlName": "System boundaries"}],
          "CIS": [{"controlId": "2.3.1", "controlName": "Ensure RDS instances are not publicly accessible"}],
          "ISO27001": [{"controlId": "A.13.1.1", "controlName": "Network controls"}],
          "PCI-DSS": [{"controlId": "1.3", "controlName": "Prohibit direct public access"}]
        },
        "nist": "PR.AC-5",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.6",
        "soc2Description": "System boundaries",
        "description": "Public RDS endpoint exposes database to internet-based attacks"
      },
      "storageEncrypted": {
        "mitre": "T1530",
        "mitreName": "Data from Cloud Storage",
        "controls": {
          "NIST-800-53": [{"controlId": "SC-28", "controlName": "Protection of Information at Rest"}],
          "NIST-CSF": [{"controlId": "PR.DS-1", "controlName": "Data-at-rest is protected"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "CIS": [{"controlId": "2.3.2", "controlName": "Ensure RDS instances have encryption at rest enabled"}],
          "ISO27001": [{"controlId": "A.10.1.1", "controlName": "Policy on the use of cryptographic controls"}],
          "PCI-DSS": [{"controlId": "3.4", "controlName": "Render PAN unreadable anywhere it is stored"}]
        },
        "nist": "PR.DS-1",
        "nistFunction": "Protect - Data Security",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Unencrypted storage allows data extraction if physical access is obtained"
      },
      "iamAuthEnabled": {
        "mitre": "T1110",
        "mitreName": "Brute Force",
        "controls": {
          "NIST-800-53": [{"controlId": "IA-2", "controlName": "Identification and Authentication"}, {"controlId": "IA-5", "controlName": "Authenticator Management"}],
          "NIST-CSF": [{"controlId": "PR.AC-7", "controlName": "Authentication mechanisms"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "CIS": [{"controlId": "2.3.3", "controlName": "Ensure IAM authentication is enabled for RDS"}],
          "ISO27001": [{"controlId": "A.9.4.2", "controlName": "Secure log-on procedures"}],
          "PCI-DSS": [{"controlId": "8.3.1", "controlName": "Multi-factor authentication"}]
        },
        "nist": "PR.AC-7",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Password-only authentication enables brute force attacks against database"
      },
      "auditLogging": {
        "mitre": "T1562",
        "mitreName": "Impair Defenses",
        "controls": {
          "NIST-800-53": [{"controlId": "AU-2", "controlName": "Audit Events"}, {"controlId": "AU-12", "controlName": "Audit Generation"}],
          "NIST-CSF": [{"controlId": "DE.CM-7", "controlName": "Monitoring for unauthorized activity"}],
          "SOC2": [{"controlId": "CC7.2", "controlName": "Monitoring of infrastructure and software"}],
          "CIS": [{"controlId": "2.3.4", "controlName": "Ensure audit logging is enabled for RDS"}],
          "ISO27001": [{"controlId": "A.12.4.1", "controlName": "Event logging"}],
          "PCI-DSS": [{"controlId": "10.1", "controlName": "Implement audit trails"}]
        },
        "nist": "DE.CM-7",
        "nistFunction": "Detect - Continuous Monitoring",
        "soc2": "CC7.2",
        "soc2Description": "Monitoring of infrastructure and software",
        "description": "No audit logging prevents detection and investigation of database breaches"
      }
    },
    "attackVectors": {
      "public-endpoint": {
        "mitre": "T1190",
        "mitreName": "Exploit Public-Facing Application",
        "nist": "PR.AC-5",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.6",
        "soc2Description": "System boundaries",
        "description": "Public endpoint test identifies RDS instances accessible from the internet"
      },
      "unencrypted-storage": {
        "mitre": "T1530",
        "mitreName": "Data from Cloud Storage",
        "nist": "PR.DS-1",
        "nistFunction": "Protect - Data Security",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Unencrypted storage test identifies RDS instances without encryption at rest"
      },
      "weak-auth": {
        "mitre": "T1110",
        "mitreName": "Brute Force",
        "nist": "PR.AC-7",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Weak authentication test identifies RDS instances without IAM authentication"
      },
      "no-audit-logging": {
        "mitre": "T1562",
        "mitreName": "Impair Defenses",
        "nist": "DE.CM-7",
        "nistFunction": "Detect - Continuous Monitoring",
        "soc2": "CC7.2",
        "soc2Description": "Monitoring of infrastructure and software",
        "description": "No audit logging test identifies RDS instances without database activity monitoring"
      }
    }
  }
}
