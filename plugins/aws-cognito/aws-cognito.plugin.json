{
  "providerId": "aws-cognito",
  "providerName": "AWS Cognito",
  "version": "1.0.0",
  "description": "Corsair plugin for AWS Cognito User Pools - enables chaos engineering and security testing of Cognito authentication configurations",
  "attackVectors": [
    {
      "id": "mfa-bypass",
      "name": "MFA Bypass",
      "description": "Tests Multi-Factor Authentication bypass scenarios by exploiting disabled or optional MFA configurations",
      "severity": "CRITICAL",
      "mitreMapping": ["T1556.006"],
      "preconditions": ["MFA is OFF or OPTIONAL"],
      "remediations": ["Enable enforced MFA (MfaConfiguration: ON)", "Require software token or SMS MFA"]
    },
    {
      "id": "password-spray",
      "name": "Password Spray",
      "description": "Tests resilience against password spraying attacks by analyzing password policy strength",
      "severity": "HIGH",
      "mitreMapping": ["T1110.003"],
      "preconditions": ["Weak password policy (length < 12, missing complexity)"],
      "remediations": ["Increase minimum password length to 12+", "Require uppercase, lowercase, numbers, and symbols"]
    },
    {
      "id": "token-replay",
      "name": "Token Replay",
      "description": "Tests token handling security by analyzing risk configuration for replay detection",
      "severity": "HIGH",
      "mitreMapping": ["T1550.001"],
      "preconditions": ["Risk configuration disabled or missing"],
      "remediations": ["Enable advanced security features", "Configure compromised credentials detection"]
    },
    {
      "id": "session-hijack",
      "name": "Session Hijack",
      "description": "Tests session security by analyzing device tracking and challenge configurations",
      "severity": "MEDIUM",
      "mitreMapping": ["T1563"],
      "preconditions": ["Device challenge disabled on new devices"],
      "remediations": ["Enable challengeRequiredOnNewDevice", "Configure device tracking"]
    }
  ],
  "capabilities": {
    "recon": true,
    "raid": true,
    "escape": true,
    "realTimeAPI": false
  },
  "requiredPermissions": [
    "cognito-idp:DescribeUserPool",
    "cognito-idp:DescribeUserPoolClient",
    "cognito-idp:GetUserPoolMfaConfig"
  ],
  "documentation": {
    "readme": "README.md",
    "examples": "examples/",
    "api": "docs/api.md"
  },
  "frameworkMappings": {
    "drift": {
      "mfaConfiguration": {
        "mitre": "T1556",
        "mitreName": "Modify Authentication Process",
        "controls": {
          "NIST-800-53": [{"controlId": "IA-2", "controlName": "Identification and Authentication"}, {"controlId": "IA-5", "controlName": "Authenticator Management"}],
          "NIST-CSF": [{"controlId": "PR.AC-7", "controlName": "Authentication mechanisms"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "CIS": [{"controlId": "6.5", "controlName": "Require MFA for Administrative Access"}],
          "ISO27001": [{"controlId": "A.9.4.2", "controlName": "Secure log-on procedures"}],
          "PCI-DSS": [{"controlId": "8.3.1", "controlName": "Multi-factor authentication"}]
        },
        "nist": "PR.AC-7",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "MFA configuration drift indicates potential authentication bypass risk"
      },
      "passwordPolicy.minimumLength": {
        "mitre": "T1110",
        "mitreName": "Brute Force",
        "controls": {
          "NIST-800-53": [{"controlId": "AC-7", "controlName": "Unsuccessful Logon Attempts"}, {"controlId": "IA-5", "controlName": "Authenticator Management"}],
          "NIST-CSF": [{"controlId": "PR.AC-1", "controlName": "Identity and credential management"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "CIS": [{"controlId": "5.2", "controlName": "Use Unique Passwords"}],
          "ISO27001": [{"controlId": "A.9.4.3", "controlName": "Password management system"}],
          "PCI-DSS": [{"controlId": "8.2.3", "controlName": "Password complexity requirements"}]
        },
        "nist": "PR.AC-1",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Weak password length enables brute force attacks"
      },
      "passwordPolicy.requireSymbols": {
        "mitre": "T1110.001",
        "mitreName": "Password Guessing",
        "controls": {
          "NIST-800-53": [{"controlId": "IA-5", "controlName": "Authenticator Management"}],
          "NIST-CSF": [{"controlId": "PR.AC-1", "controlName": "Identity and credential management"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "ISO27001": [{"controlId": "A.9.4.3", "controlName": "Password management system"}],
          "PCI-DSS": [{"controlId": "8.2.3", "controlName": "Password complexity requirements"}]
        },
        "nist": "PR.AC-1",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Missing symbol requirement reduces password entropy"
      },
      "riskConfiguration": {
        "mitre": "T1078",
        "mitreName": "Valid Accounts",
        "controls": {
          "NIST-800-53": [{"controlId": "AC-2", "controlName": "Account Management"}, {"controlId": "AC-6", "controlName": "Least Privilege"}],
          "NIST-CSF": [{"controlId": "PR.AC-4", "controlName": "Access permissions and authorizations"}],
          "SOC2": [{"controlId": "CC6.2", "controlName": "Registration and authorization"}],
          "CIS": [{"controlId": "6.2", "controlName": "Ensure No Duplicate User Names"}],
          "ISO27001": [{"controlId": "A.9.2.5", "controlName": "Review of user access rights"}],
          "PCI-DSS": [{"controlId": "7.1", "controlName": "Limit access to system components"}]
        },
        "nist": "PR.AC-4",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.2",
        "soc2Description": "Registration and authorization",
        "description": "Missing risk configuration allows compromised credential usage"
      },
      "softwareTokenMfaEnabled": {
        "mitre": "T1556.006",
        "mitreName": "Multi-Factor Authentication Interception",
        "controls": {
          "NIST-800-53": [{"controlId": "IA-2", "controlName": "Identification and Authentication"}, {"controlId": "IA-5", "controlName": "Authenticator Management"}],
          "NIST-CSF": [{"controlId": "PR.AC-7", "controlName": "Authentication mechanisms"}],
          "SOC2": [{"controlId": "CC6.1", "controlName": "Logical access security"}],
          "CIS": [{"controlId": "6.5", "controlName": "Require MFA for Administrative Access"}],
          "ISO27001": [{"controlId": "A.9.4.2", "controlName": "Secure log-on procedures"}],
          "PCI-DSS": [{"controlId": "8.3.1", "controlName": "Multi-factor authentication"}]
        },
        "nist": "PR.AC-7",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Software token MFA disabled allows authentication bypass"
      }
    },
    "attackVectors": {
      "mfa-bypass": {
        "mitre": "T1556.006",
        "mitreName": "Multi-Factor Authentication Interception",
        "nist": "PR.AC-7",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "MFA bypass allows unauthorized authentication without second factor"
      },
      "password-spray": {
        "mitre": "T1110.003",
        "mitreName": "Password Spraying",
        "nist": "PR.AC-1",
        "nistFunction": "Protect - Access Control",
        "soc2": "CC6.1",
        "soc2Description": "Logical access security",
        "description": "Password spraying exploits weak password policies"
      },
      "token-replay": {
        "mitre": "T1550.001",
        "mitreName": "Application Access Token",
        "nist": "PR.DS-2",
        "nistFunction": "Protect - Data Security",
        "soc2": "CC6.6",
        "soc2Description": "System boundary protection",
        "description": "Token replay exploits lack of replay detection"
      },
      "session-hijack": {
        "mitre": "T1563",
        "mitreName": "Remote Service Session Hijacking",
        "nist": "PR.IP-1",
        "nistFunction": "Protect - Information Protection",
        "soc2": "CC6.3",
        "soc2Description": "Role-based access control",
        "description": "Session hijacking exploits weak device tracking"
      }
    }
  }
}
