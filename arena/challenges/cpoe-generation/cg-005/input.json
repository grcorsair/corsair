{
  "SchemaVersion": 2,
  "ArtifactName": "acme-platform:v2.4.1",
  "ArtifactType": "container_image",
  "Metadata": {
    "OS": {
      "Family": "debian",
      "Name": "12.8"
    },
    "ImageConfig": {
      "architecture": "amd64",
      "created": "2026-02-01T14:32:00Z"
    }
  },
  "Results": [
    {
      "Target": "Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS001",
          "AVDID": "AVD-DS-0001",
          "Title": "':latest' tag used",
          "Description": "When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.",
          "Severity": "MEDIUM",
          "Status": "FAIL",
          "Resolution": "Add a specific tag to the base image in the FROM statement, e.g., 'FROM node:20.11.0-bookworm-slim' instead of 'FROM node:latest'."
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS002",
          "AVDID": "AVD-DS-0002",
          "Title": "Image user should not be 'root'",
          "Description": "Running containers as root user increases the risk of container escape and privilege escalation attacks. A non-root user should be specified in the Dockerfile.",
          "Severity": "HIGH",
          "Status": "PASS",
          "Resolution": "Add 'USER nonroot' directive to the Dockerfile after installing dependencies."
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS005",
          "AVDID": "AVD-DS-0005",
          "Title": "ADD instead of COPY",
          "Description": "You should use COPY instead of ADD unless you need the specific features of ADD (tar extraction, URL fetching). COPY is more predictable.",
          "Severity": "LOW",
          "Status": "FAIL",
          "Resolution": "Replace ADD instructions with COPY unless the ADD-specific feature (tar auto-extraction) is required."
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS026",
          "AVDID": "AVD-DS-0026",
          "Title": "No HEALTHCHECK defined",
          "Description": "A HEALTHCHECK instruction should be defined in the Dockerfile so Docker can test if the container is still working. Without a health check, Docker has no way to know if the process is still operational.",
          "Severity": "LOW",
          "Status": "FAIL",
          "Resolution": "Add a HEALTHCHECK instruction: HEALTHCHECK --interval=30s --timeout=5s --retries=3 CMD curl -f http://localhost:3000/health || exit 1"
        }
      ]
    },
    {
      "Target": "apps/api/package-lock.json",
      "Class": "lang-pkgs",
      "Type": "npm",
      "Vulnerabilities": [
        {
          "VulnerabilityID": "CVE-2024-48949",
          "PkgName": "elliptic",
          "InstalledVersion": "6.5.4",
          "FixedVersion": "6.6.0",
          "Severity": "CRITICAL",
          "Title": "elliptic: ECDSA signature verification vulnerability",
          "Description": "The elliptic package before 6.6.0 for Node.js has a signature verification vulnerability that allows an attacker to forge ECDSA signatures, leading to authentication bypass in systems relying on this library for cryptographic verification."
        },
        {
          "VulnerabilityID": "CVE-2025-29927",
          "PkgName": "next",
          "InstalledVersion": "14.2.15",
          "FixedVersion": "14.2.25",
          "Severity": "HIGH",
          "Title": "Next.js middleware authorization bypass",
          "Description": "Next.js before 14.2.25 allows authorization bypass via the x-middleware-subrequest header. An attacker can craft requests that skip middleware checks, potentially bypassing authentication and authorization logic."
        },
        {
          "VulnerabilityID": "CVE-2024-47764",
          "PkgName": "cookie",
          "InstalledVersion": "0.6.0",
          "FixedVersion": "0.7.0",
          "Severity": "MEDIUM",
          "Title": "cookie: improper parsing allows prototype pollution",
          "Description": "The cookie package before 0.7.0 for Node.js improperly handles cookie names, allowing attackers to set cookies with keys like __proto__, potentially enabling prototype pollution in certain application configurations."
        },
        {
          "VulnerabilityID": "CVE-2024-55565",
          "PkgName": "nanoid",
          "InstalledVersion": "3.3.7",
          "FixedVersion": "3.3.8",
          "Severity": "LOW",
          "Title": "nanoid: predictable output in certain environments",
          "Description": "nanoid before 3.3.8 has reduced entropy in environments where crypto.getRandomValues uses a weak RNG fallback, potentially making generated IDs guessable in edge runtime environments."
        }
      ]
    },
    {
      "Target": "infrastructure/terraform/main.tf",
      "Class": "config",
      "Type": "terraform",
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 bucket does not have encryption enabled",
          "Description": "S3 buckets should be encrypted at rest to protect sensitive data. Use SSE-S3, SSE-KMS, or SSE-C encryption.",
          "Severity": "HIGH",
          "Status": "PASS",
          "Resolution": "Add server_side_encryption_configuration block to the aws_s3_bucket resource with AES256 or aws:kms algorithm."
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0089",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 bucket does not have versioning enabled",
          "Description": "S3 bucket versioning should be enabled to maintain a history of object modifications and deletions, enabling recovery from unintended changes.",
          "Severity": "MEDIUM",
          "Status": "FAIL",
          "Resolution": "Add a versioning block with enabled = true to the aws_s3_bucket resource, or use the aws_s3_bucket_versioning resource."
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "RDS instance has public access enabled",
          "Description": "Database instances should not be publicly accessible. Making an RDS instance publicly accessible exposes it to the internet and increases the attack surface.",
          "Severity": "CRITICAL",
          "Status": "FAIL",
          "Resolution": "Set publicly_accessible = false in the aws_db_instance resource. Use VPC endpoints or a bastion host for database access."
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0104",
          "AVDID": "AVD-AWS-0104",
          "Title": "CloudWatch log group does not have retention policy",
          "Description": "CloudWatch log groups should have retention periods configured. Without a retention policy, logs are kept indefinitely, incurring unnecessary storage costs.",
          "Severity": "LOW",
          "Status": "PASS",
          "Resolution": "Set the retention_in_days argument on the aws_cloudwatch_log_group resource to an appropriate value (e.g., 90, 180, or 365 days)."
        }
      ]
    }
  ]
}
