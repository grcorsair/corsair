---
title: "The CPOE Lifecycle"
description: "How security tool output becomes a cryptographically verifiable CPOE."
section: "concepts"
order: 10
---

## Overview

The Corsair pipeline transforms security tool output into cryptographically signed, universally verifiable Certificates of Proof of Operational Effectiveness (CPOEs). The default signing path is fully deterministic — no AI, no judgment, just provenance recording and Ed25519 signing.

```
EVIDENCE → SIGN → LOG → VERIFY → DIFF
```

Optional enrichment layers (available via `--enrich`):

- **CHART** — Map controls to 13+ compliance frameworks
- **QUARTER** — AI-powered evidence governance review
- **FLAGSHIP** — Real-time compliance change notifications via SSF/SET/CAEP

## Core Pipeline

### EVIDENCE — Tool Output Acceptance

Accepts structured output from security scanning tools and compliance platforms, normalizing it into a canonical control format for signing.

**Supported tool formats (8 total, auto-detected):**
- `prowler` — Prowler AWS/Azure/GCP security scan results (OCSF JSON)
- `securityhub` — AWS SecurityHub findings (ASFF JSON)
- `inspec` — Chef InSpec compliance test results (JSON)
- `trivy` — Trivy vulnerability and misconfiguration reports (JSON)
- `gitlab` — GitLab SAST vulnerability reports (JSON)
- `ciso-assistant-api` — CISO Assistant API response (DRF paginated JSON)
- `ciso-assistant-export` — CISO Assistant export (Django JSON)
- `generic` — Pre-structured control data from any source `{ metadata, controls[] }`

**Output:** Structured controls with evidence references, provenance metadata, and pass/fail status.

```bash
corsair sign --file prowler-results.json --format prowler
```

### SIGN — Provenance Recording + Ed25519 Signing

The signing stage records provenance (who produced the evidence) and signs the result as a JWT-VC:

| Provenance | Meaning |
|------------|---------|
| **self** | Organization self-attests without automated evidence |
| **tool** | Security tool (Prowler, InSpec, Trivy) produced the evidence |
| **auditor** | Independent third party reviewed and verified the assessment |

**CPOE format:**

```
Header:  { "alg": "EdDSA", "typ": "vc+jwt", "kid": "did:web:grcorsair.com#key-1" }
Payload: { "iss": "did:web:grcorsair.com", "vc": { ... CPOE ... }, "parley": "2.0" }
Signature: Ed25519
```

Corsair does not judge evidence quality. It records where the evidence came from, signs it, and lets buyers decide what's sufficient.

### LOG — SCITT Transparency Registration

CPOEs are registered with an IETF SCITT transparency log. Registration produces a COSE receipt proving inclusion in the append-only log:

- **Non-repudiation** — The issuer cannot deny having issued the attestation at the recorded time
- **Discoverability** — Third parties can audit the transparency log to verify CPOE history

The SCITT registry uses SHA-256 Merkle tree hashing with COSE_Sign1 signed receipts (RFC 9052, Ed25519).

### VERIFY — Signature + Provenance Verification

Anyone with the issuer's public key (resolved via `did:web`) can verify a CPOE:

1. Decode the JWT header + payload (base64url)
2. Resolve the issuer's DID document via HTTPS
3. Extract the public key matching `header.kid`
4. Verify Ed25519 signature

No server, no account, no data sharing required.

### DIFF — Compare CPOEs Over Time

Track compliance changes between assessments — like `git diff` for compliance:

```bash
corsair diff --current cpoe-v2.jwt --previous cpoe-v1.jwt
```

Shows control-level additions, removals, status changes, and score deltas.

## Higher-Level Workflows

Built on top of the core primitives, these commands compose the pipeline stages into end-to-end workflows:

### AUDIT — Full Compliance Audit

Run a complete audit across multiple evidence files with scoring, framework targeting, and optional governance checks:

```bash
corsair audit --files prowler.json inspec.json --scope "AWS Production" --frameworks SOC2,NIST-800-53
```

Audit combines EVIDENCE + SIGN + scoring into a single operation, producing a comprehensive audit result with findings, score breakdowns, and optional governance review.

### CERT — Continuous Certifications

Manage ongoing compliance certifications with lifecycle tracking:

```bash
corsair cert create --scope "AWS Production" --frameworks SOC2 --files evidence/*.json
corsair cert check <cert-id>
corsair cert renew <cert-id> --files new-evidence/*.json
```

Certifications track status (active, warning, degraded, suspended, expired, revoked), detect drift on renewal, and enforce minimum score thresholds.

### TPRM — Third-Party Risk Management

Automate vendor risk assessment using CPOEs as the evidence layer:

```bash
corsair tprm register --name "Acme Cloud" --domain acme.com --risk-tier high
corsair tprm assess --vendor <id> --frameworks SOC2 --cpoes vendor-cpoe.jwt
corsair tprm dashboard
```

TPRM replaces questionnaire-based vendor assessment with cryptographically verifiable CPOE-based evaluation, producing approve/conditional/deny decisions with composite scoring.

### RENEW — Re-sign CPOEs

Re-sign an existing CPOE with fresh dates, or with new evidence while preserving scope and DID:

```bash
corsair renew --file cpoe.jwt --output renewed.jwt
corsair renew --file cpoe.jwt --evidence new-findings.json --output renewed.jwt
```

## Evidence Quality Scoring

The `--score` flag on `corsair sign` runs a 7-dimension evidence quality assessment (FICO-style composite score):

```bash
corsair sign --file evidence.json --score --json
```

Dimensions include evidence integrity, completeness, methodology, freshness, provenance strength, control coverage, and consistency. The composite score (0-100) with letter grade provides a standardized quality metric for CPOE consumers.

## Optional Enrichment (--enrich)

These layers are available via the `--enrich` flag but are not part of the default signing path:

### CHART — Framework Mapping

Maps controls to 13+ compliance frameworks using a 2-tier resolution system:

1. **CTID ATT&CK-to-NIST data** — 6,300+ mappings from the Center for Threat-Informed Defense
2. **SCF crosswalk** — Secure Controls Framework mapping to 175+ frameworks

Supported frameworks include NIST 800-53, NIST CSF, SOC 2, ISO 27001, PCI-DSS, HIPAA, GDPR, CMMC, FedRAMP, CIS Controls, SOX, and COBIT.

### QUARTER — Governance Review

AI-powered governance assessment evaluating four dimensions:

| Dimension | Weight | What It Measures |
|-----------|--------|------------------|
| Methodology | 30% | Assessment approach quality and rigor |
| Evidence Integrity | 25% | Cryptographic chain validity and completeness |
| Completeness | 25% | Coverage of in-scope controls |
| Bias | 20% | Independence and objectivity of evidence |

Produces a confidence score (0-100) and trust tier.

### FLAGSHIP — Real-Time Compliance Signals

FLAGSHIP delivers standardized compliance change notifications via the OpenID Shared Signals Framework (SSF) and Continuous Access Evaluation Protocol (CAEP). See [FLAGSHIP Events](/docs/concepts/flagship-events) for details.
