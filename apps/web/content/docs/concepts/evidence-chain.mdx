---
title: "Evidence Chain"
description: "SHA-256 hash chain that provides tamper-proof cryptographic integrity for all Corsair evidence."
section: "concepts"
order: 13
---

## Overview

Every Corsair mission produces an **evidence chain** — a JSONL file where each record is cryptographically linked to the previous one via SHA-256 hashing. This creates a tamper-proof audit trail that proves no evidence has been modified after collection.

## How It Works

Each evidence record contains:

```json
{
  "sequenceNumber": 1,
  "timestamp": "2026-02-06T10:30:00.000Z",
  "phase": "RECON",
  "type": "snapshot",
  "data": { "...": "..." },
  "previousHash": "0000000000000000000000000000000000000000000000000000000000000000",
  "hash": "a3f8b2c1d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0"
}
```

### Chain Mechanics

1. The first record has `previousHash` set to all zeros (genesis)
2. Each subsequent record includes the `hash` of the previous record as its `previousHash`
3. The `hash` is computed as `SHA-256(JSON.stringify(record_without_hash))`
4. Breaking any record invalidates all subsequent hashes

## Verification

Verify a chain programmatically:

```typescript
import { verifyChain } from "corsair/evidence";

const records = readJsonl("./evidence/mission.jsonl");
const result = verifyChain(records);
// { valid: true, recordCount: 12, brokenAt: null }
```

Or via the CLI:

```bash
bun corsair.ts --verify ./evidence/mission.jsonl
```

## Evidence Phases

Evidence records are tagged with their pipeline phase:

| Phase | Evidence Type |
|-------|--------------|
| RECON | Configuration snapshot |
| SPYGLASS | Threat model results |
| MARK | Drift findings (DRIFT/HOLD) |
| RAID | Attack results (SUCCEEDED/BLOCKED) |
| PLUNDER | Extracted evidence artifacts |
| CHART | Framework mapping results |
| QUARTER | Governance scores |
| MARQUE | Signed attestation reference |

## JSONL Format

Evidence uses JSONL (JSON Lines) — one JSON object per line. This format is:

- **Appendable** — New records are appended without rewriting the file
- **Streamable** — Process records one at a time without loading the full file
- **Portable** — Standard format supported by jq, Splunk, Datadog, etc.

## Integration

Evidence chains integrate with:

- **OSCAL output** — Hash chain status included in Assessment Results metadata
- **Marque documents** — Chain root hash and record count are part of the signed attestation
- **GRC platforms** — JSONL can be ingested by ServiceNow, Jira, Splunk via webhooks

## Compaction

For long-running or repeated missions, the evidence compaction engine can merge multiple chains while preserving integrity:

```bash
bun corsair.ts --compact ./evidence/mission-*.jsonl --output ./evidence/compacted.jsonl
```

Compaction creates a new chain that references the original chains' root hashes, maintaining the full audit trail.

## SCITT Transparency Log Integration

As part of the Parley protocol, evidence chains can be registered with an IETF SCITT (Supply Chain Integrity, Transparency, and Trust) transparency service. When a Marque is issued, the signed attestation and its evidence chain root hash can be submitted as a SCITT statement, producing a COSE receipt that proves inclusion in the append-only log.

This provides two properties beyond the existing hash chain:

- **Non-repudiation** — The issuer cannot deny having issued the attestation at the recorded time
- **Discoverability** — Third parties can audit the transparency log to verify CPOE history

SCITT integration is defined at the type/interface level in the current release. Full transparency service integration is on the roadmap, tracking the IETF SCITT Architecture draft as it progresses toward RFC status.
