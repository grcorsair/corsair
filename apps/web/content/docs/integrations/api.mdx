---
title: "REST API"
description: "Corsair REST API for signing and verifying CPOEs programmatically."
section: "integrations"
order: 31
---

## Overview

The Corsair REST API provides programmatic access to CPOE signing and verification. All endpoints follow a consistent JSON envelope with request IDs for tracing.

**Base URL:** `https://api.grcorsair.com`

**Versioned API:** `https://api.grcorsair.com/v1` (recommended)

Every response includes:
- `X-Request-Id` header for tracing
- `X-Corsair-Version` header with the API version
- CORS headers (`Access-Control-Allow-Origin: *`)

## Authentication

Protected endpoints require a Bearer token in the `Authorization` header. API keys are provisioned per-organization.

```bash
curl -X POST https://api.grcorsair.com/v1/sign \
  -H "Authorization: Bearer csk_live_abc123..." \
  -H "Content-Type: application/json" \
  -d '{"evidence": {...}}'
```

Public endpoints (verify, health) require no authentication.

| Endpoint | Auth Required |
|:---------|:-------------|
| `GET /v1/health` | No |
| `POST /v1/sign` | Yes |
| `POST /v1/verify` | No |

## Response Envelope

```json
{
  "ok": true,
  "data": { ... }
}
```

Error responses use the same envelope:

```json
{
  "ok": false,
  "error": {
    "code": "validation_error",
    "message": "Missing required field: \"evidence\""
  }
}
```

## POST /v1/sign

Sign evidence into a CPOE (JWT-VC). Accepts raw tool output via mapping packs or generic format. Requires authentication.
To support additional tools without code changes, configure the mapping registry on the API server via `CORSAIR_MAPPING_DIR`, `CORSAIR_MAPPING_FILE`, or `corsair mappings add`. Build packs with `corsair mappings pack` and sign them with `corsair mappings sign`. Mappings are evaluated by priority (higher wins), then filename order. Signed packs are verified when `CORSAIR_MAPPING_PACK_PUBKEY` is set.

```bash
curl -X POST https://api.grcorsair.com/v1/sign \
  -H "Authorization: Bearer $CORSAIR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "evidence": {
      "metadata": { "title": "S3 Controls", "issuer": "Acme", "scope": "AWS Production" },
      "controls": [
        { "id": "S3-001", "description": "Bucket versioning enabled", "status": "pass" }
      ]
    },
    "scope": "AWS Production - S3 Controls",
    "expiryDays": 90
  }'
```

**Request Body:**

| Field | Type | Required | Description |
|:------|:-----|:---------|:-----------|
| `evidence` | object or string | Yes | Raw tool output (mapping pack or generic) |
| `format` | string | No | Force generic format (bypasses mapping registry) |
| `did` | string | No | Override issuer DID (e.g., `did:web:acme.com`) |
| `scope` | string | No | Override scope description |
| `expiryDays` | number | No | CPOE validity in days (default: 7) |
| `dryRun` | boolean | No | Parse without signing |
| `dependencies` | array | No | Dependency proofs to attach (trust graph) |

**Response:**

```json
{
  "ok": true,
  "data": {
    "cpoe": "eyJhbGciOiJFZERTQSIsInR5cCI6InZjK2p3dCIs...",
    "marqueId": "marque-a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "detectedFormat": "generic",
    "summary": {
      "controlsTested": 24,
      "controlsPassed": 22,
      "controlsFailed": 2,
      "overallScore": 91
    },
    "provenance": {
      "source": "tool",
      "sourceIdentity": "Acme",
      "sourceDate": "2026-02-13T00:00:00Z"
    },
    "extensions": {
      "mapping": { "id": "toolx-evidence-only", "evidenceOnly": true },
      "passthrough": { "summary": { "passed": 12, "failed": 2 } }
    },
    "warnings": [],
    "expiresAt": "2026-05-14T00:00:00.000Z"
  }
}
```

## POST /v1/verify

Verify a CPOE signature and extract attestation details. No authentication required.
Optional policy checks and process receipt verification are supported.


Policy fields include:
- `requireSource` (`self` | `tool` | `auditor`)
- `requireSourceIdentity` (array of allowed identities)
- `requireToolAttestation` (boolean)
- `requireInputBinding` (boolean, requires `sourceDocumentHash`)
- `requireEvidenceChain` (boolean, CLI-only because it needs the JSONL evidence file)
- `requireReceipts` (boolean)
- `requireScitt` (boolean)

```bash
curl -X POST https://api.grcorsair.com/v1/verify \
  -H "Content-Type: application/json" \
  -d '{
    "cpoe": "eyJhbGciOiJFZERTQSIsInR5cCI6InZjK2p3dCIs...",
    "policy": {
      "requireIssuer": "did:web:grcorsair.com",
      "requireFramework": ["SOC2"],
      "maxAgeDays": 30,
      "minScore": 90,
      "requireSource": "tool",
      "requireSourceIdentity": ["Scanner v1.2"],
      "requireReceipts": true,
      "requireScitt": true,
      "requireInputBinding": true
    },
    "receipts": [],
    "sourceDocumentHash": "a2b4c6d8..."
  }'
```

**Response:**

```json
{
  "ok": true,
  "data": {
    "valid": true,
    "issuer": "did:web:grcorsair.com",
    "trustTier": "corsair-verified",
    "scope": "SOC 2 Type II - AWS Production Controls",
    "summary": {
      "controlsTested": 24,
      "controlsPassed": 22,
      "controlsFailed": 2,
      "overallScore": 91
    },
    "provenance": {
      "source": "tool",
      "sourceIdentity": "Scanner v1.2",
      "sourceDate": "2026-01-15"
    },
    "extensions": {
      "mapping": { "id": "toolx-evidence-only", "evidenceOnly": true },
      "passthrough": { "summary": { "passed": 12, "failed": 2 } }
    },
    "timestamps": {
      "issuedAt": "2026-02-13T00:00:00.000Z",
      "expiresAt": "2026-05-14T00:00:00.000Z"
    },
    "policy": { "ok": true, "errors": [] },
    "process": { "chainValid": true, "receiptsVerified": 2, "receiptsTotal": 2 },
    "inputBinding": { "ok": true, "errors": [] }
  }
}
```

`sourceDocumentHash` should be the SHA-256 of canonical JSON (sorted keys), matching `provenance.sourceDocument`.
