---
title: "REST API"
description: "Corsair REST API for signing, verifying, and managing CPOEs programmatically."
section: "integrations"
order: 31
---

## Overview

The Corsair REST API provides programmatic access to CPOE signing, verification, transparency logging, certification management, and third-party risk management. All endpoints follow Stripe-style conventions with consistent JSON envelopes, request IDs, and typed error codes.

**Base URL:** `https://api.grcorsair.com`

**Versioned API:** `https://api.grcorsair.com/v1` (recommended for new integrations)

Every response includes:
- `X-Request-Id` header for tracing
- `X-Corsair-Version` header with the API version
- CORS headers (`Access-Control-Allow-Origin: *`)

## Authentication

Protected endpoints require a Bearer token in the `Authorization` header. API keys are provisioned per-organization.

```bash
curl -X POST https://api.grcorsair.com/v1/sign \
  -H "Authorization: Bearer csk_live_abc123..." \
  -H "Content-Type: application/json" \
  -d '{"evidence": {...}}'
```

Public endpoints (verify, health, cert status, SCITT list, well-known discovery) require no authentication.

| Endpoint | Auth Required |
|:---------|:-------------|
| `POST /v1/sign` | Yes |
| `POST /v1/verify` | No |
| `GET /v1/health` | No |
| `POST /audit` | Yes |
| `POST /cert` | Yes |
| `GET /cert/list` | Yes |
| `GET /cert/status` | No |
| `POST /tprm/assess` | Yes |
| `GET /tprm/vendors` | Yes |
| `POST /tprm/vendors` | Yes |
| `GET /tprm/dashboard` | Yes |
| `POST /webhooks` | Yes |
| `GET /webhooks` | Yes |
| `DELETE /webhooks` | Yes |
| `POST /scitt/entries` | Yes |
| `GET /scitt/entries` | No |
| `GET /billing` | Yes |
| `POST /billing/subscribe` | Yes |
| `POST /billing/cancel` | Yes |
| Well-known discovery | No |

Missing or invalid credentials return `401` (no header) or `403` (bad key):

```json
{ "error": "Missing or invalid Authorization header. Use: Bearer <api-key>" }
```

## Rate Limiting

All endpoints are rate-limited by client IP using a sliding window. When the limit is exceeded, the API returns `429 Too Many Requests` with a `Retry-After` header indicating seconds until the window resets.

```json
{ "error": "Too many requests" }
```

## Response Envelope

The versioned `/v1/` endpoints wrap all responses in a standard envelope:

```json
{
  "ok": true,
  "data": { ... }
}
```

Error responses use the same envelope:

```json
{
  "ok": false,
  "error": {
    "code": "validation_error",
    "message": "Missing required field: \"evidence\""
  }
}
```

### Error Codes

| Code | HTTP Status | Meaning |
|:-----|:-----------|:--------|
| `bad_request` | 400 | Malformed request body |
| `validation_error` | 400 | Missing or invalid fields |
| `payload_too_large` | 400 | Evidence or JWT exceeds size limit |
| `unauthorized` | 401 | Missing authentication |
| `forbidden` | 403 | Invalid API key |
| `not_found` | 404 | Route or resource not found |
| `method_not_allowed` | 405 | Wrong HTTP method |
| `rate_limited` | 429 | Too many requests |
| `internal_error` | 500 | Server error |

---

## Core Endpoints

### POST /v1/sign

Sign evidence into a CPOE (JWT-VC). Accepts raw tool output from any of the 8 supported formats. Requires authentication.

**Idempotency:** Include an `X-Idempotency-Key` header to safely retry requests. Cached responses expire after 1 hour.

**Size limit:** Evidence payload must not exceed 500KB.

```bash
curl -X POST https://api.grcorsair.com/v1/sign \
  -H "Authorization: Bearer $CORSAIR_API_KEY" \
  -H "Content-Type: application/json" \
  -H "X-Idempotency-Key: sign-prowler-2026-02-13" \
  -d '{
    "evidence": {
      "StatusCode": "PASS",
      "FindingInfo": { "Title": "S3 bucket versioning enabled" }
    },
    "format": "prowler",
    "scope": "AWS Production - S3 Controls",
    "expiryDays": 90
  }'
```

**Request Body:**

| Field | Type | Required | Description |
|:------|:-----|:---------|:-----------|
| `evidence` | object or string | Yes | Raw tool output (any supported format) |
| `format` | string | No | Force parser format. Auto-detected if omitted. One of: `generic`, `prowler`, `securityhub`, `inspec`, `trivy`, `gitlab`, `ciso-assistant-api`, `ciso-assistant-export` |
| `did` | string | No | Override issuer DID (e.g., `did:web:acme.com`) |
| `scope` | string | No | Override scope description |
| `expiryDays` | number | No | CPOE validity in days (default: 7) |
| `dryRun` | boolean | No | Parse and classify without signing |

**Response:**

```json
{
  "ok": true,
  "data": {
    "cpoe": "eyJhbGciOiJFZERTQSIsInR5cCI6InZjK2p3dCIs...",
    "marqueId": "marque-a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "detectedFormat": "prowler",
    "summary": {
      "controlsTested": 24,
      "controlsPassed": 22,
      "controlsFailed": 2,
      "overallScore": 91
    },
    "provenance": {
      "source": "tool",
      "sourceIdentity": "Prowler v3.1",
      "sourceDate": "2026-02-13T00:00:00Z"
    },
    "warnings": [],
    "expiresAt": "2026-05-14T00:00:00.000Z"
  }
}
```

### POST /v1/verify

Verify a CPOE signature and extract attestation details. No authentication required -- verification is always free.

Accepts either a JSON body with a `cpoe` field or a raw JWT string.

**Size limit:** JWT must not exceed 20KB.

```bash
# JSON body
curl -X POST https://api.grcorsair.com/v1/verify \
  -H "Content-Type: application/json" \
  -d '{
    "cpoe": "eyJhbGciOiJFZERTQSIsInR5cCI6InZjK2p3dCIs..."
  }'

# Raw JWT string
curl -X POST https://api.grcorsair.com/v1/verify \
  -H "Content-Type: text/plain" \
  -d 'eyJhbGciOiJFZERTQSIsInR5cCI6InZjK2p3dCIs...'
```

**Verification flow:**
1. Resolve the issuer's `did:web` DID document via HTTPS
2. Extract the Ed25519 public key matching the JWT `kid` header
3. Verify the Ed25519 signature
4. Fall back to Corsair's trusted keys if DID resolution fails

**Response:**

```json
{
  "ok": true,
  "data": {
    "valid": true,
    "issuer": "did:web:grcorsair.com",
    "trustTier": "corsair-verified",
    "scope": "SOC 2 Type II - AWS Production Controls",
    "summary": {
      "controlsTested": 24,
      "controlsPassed": 22,
      "controlsFailed": 2,
      "overallScore": 91
    },
    "provenance": {
      "source": "tool",
      "sourceIdentity": "Prowler v3.1",
      "sourceDate": "2026-01-15"
    },
    "assurance": {
      "level": 1,
      "name": "Configured"
    },
    "timestamps": {
      "issuedAt": "2026-02-09T00:00:00.000Z",
      "expiresAt": "2026-02-16T00:00:00.000Z"
    },
    "processProvenance": {
      "chainDigest": "a7f3e2...",
      "receiptCount": 4,
      "chainVerified": true,
      "reproducibleSteps": 3,
      "attestedSteps": 1
    }
  }
}
```

**Trust Tiers:**

| Tier | Condition |
|:-----|:---------|
| `corsair-verified` | Signed by `did:web:grcorsair.com`, valid Ed25519 signature |
| `self-signed` | Valid signature, issuer DID resolves, not Corsair-signed |
| `unverifiable` | DID resolution failed (issuer unreachable) |
| `invalid` | Signature verification failed, JWT malformed, or expired |

When verification fails, the response includes a `reason` field:

```json
{
  "ok": true,
  "data": {
    "valid": false,
    "reason": "signature_invalid",
    "trustTier": "invalid",
    ...
  }
}
```

### GET /v1/health

Health check with database connectivity status. No authentication required.

```bash
curl https://api.grcorsair.com/v1/health
```

**Response:**

```json
{
  "ok": true,
  "data": {
    "status": "ok",
    "version": "0.5.1",
    "timestamp": "2026-02-13T12:00:00.000Z"
  }
}
```

The full health endpoint (with database check) returns additional detail:

```json
{
  "status": "ok",
  "version": "0.5.1",
  "timestamp": "2026-02-13T12:00:00.000Z",
  "checks": {
    "database": "connected"
  }
}
```

If the database is unreachable, the status becomes `"degraded"` with HTTP 503.

---

## SCITT Transparency Log

The SCITT (Supply Chain Integrity, Transparency, and Trust) endpoints provide an append-only transparency log for CPOE registration and auditability.

### POST /scitt/entries

Register a signed statement (CPOE JWT) in the SCITT transparency log. Returns a COSE receipt with Merkle proof.

**Size limit:** Statement must not exceed 50KB.

```bash
curl -X POST https://api.grcorsair.com/scitt/entries \
  -H "Authorization: Bearer $CORSAIR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "statement": "eyJhbGciOiJFZERTQSIsInR5cCI6InZjK2p3dCIs..."
  }'
```

**Response (201 Created):**

```json
{
  "entryId": "entry-a7f3e2b1-4c5d-6e7f-8a9b-0c1d2e3f4a5b",
  "registrationTime": "2026-02-13T12:00:00.000Z",
  "receipt": "0oRYJqRh..."
}
```

### GET /scitt/entries/:id

Retrieve metadata for a registered SCITT entry.

```bash
curl https://api.grcorsair.com/scitt/entries/entry-a7f3e2b1
```

### GET /scitt/entries/:id/receipt

Retrieve the COSE receipt (Merkle inclusion proof) for a registered entry.

```bash
curl https://api.grcorsair.com/scitt/entries/entry-a7f3e2b1/receipt
```

### GET /scitt/entries

List SCITT entries with pagination and filtering. No authentication required.

```bash
# List recent entries (default: 20 per page)
curl https://api.grcorsair.com/scitt/entries

# Paginate
curl "https://api.grcorsair.com/scitt/entries?limit=50&offset=20"

# Filter by issuer
curl "https://api.grcorsair.com/scitt/entries?issuer=did:web:acme.com"

# Filter by framework
curl "https://api.grcorsair.com/scitt/entries?framework=SOC2"
```

**Query Parameters:**

| Parameter | Type | Default | Description |
|:----------|:-----|:--------|:-----------|
| `limit` | number | 20 | Page size (1-100) |
| `offset` | number | 0 | Skip N entries |
| `issuer` | string | -- | Filter by issuer DID |
| `framework` | string | -- | Filter by framework name |

**Response:**

```json
{
  "entries": [
    {
      "entryId": "entry-a7f3e2b1...",
      "registrationTime": "2026-02-13T12:00:00.000Z",
      "issuer": "did:web:grcorsair.com",
      "scope": "SOC 2 Type II - Cloud Infrastructure",
      "provenance": {
        "source": "tool",
        "sourceIdentity": "Prowler v3.1"
      },
      "assuranceLevel": 1,
      "summary": {
        "controlsTested": 24,
        "controlsPassed": 22,
        "controlsFailed": 2,
        "overallScore": 91
      }
    }
  ],
  "pagination": {
    "limit": 20,
    "offset": 0,
    "count": 1
  }
}
```

---

## Audit

### POST /audit

Run a compliance audit across multiple evidence files. Combines tool outputs, scores evidence quality, and maps to compliance frameworks. Requires authentication.

```bash
curl -X POST https://api.grcorsair.com/audit \
  -H "Authorization: Bearer $CORSAIR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "files": ["prowler-output.json", "inspec-results.json"],
    "scope": "Q1 2026 Compliance Review",
    "frameworks": ["SOC2", "NIST-800-53"],
    "config": {
      "minimumScore": 70
    }
  }'
```

**Request Body:**

| Field | Type | Required | Description |
|:------|:-----|:---------|:-----------|
| `files` | string[] | Yes | Array of evidence file paths |
| `scope` | string | Yes | Audit scope description |
| `frameworks` | string[] | No | Target compliance frameworks |
| `config` | object | No | Audit configuration overrides |

**Response:**

```json
{
  "ok": true,
  "data": {
    "auditId": "audit-b2c3d4e5...",
    "scope": "Q1 2026 Compliance Review",
    "overallScore": 87,
    "grade": "B+",
    "frameworks": {
      "SOC2": { "controlsMapped": 24, "passed": 22, "failed": 2 },
      "NIST-800-53": { "controlsMapped": 18, "passed": 16, "failed": 2 }
    },
    "summary": {
      "controlsTested": 42,
      "controlsPassed": 38,
      "controlsFailed": 4,
      "evidenceFiles": 2
    }
  }
}
```

---

## Certification

### POST /cert

Create a new compliance certification for an organization. Runs an initial audit against the provided scope, then creates the certification record. Requires authentication.

```bash
curl -X POST https://api.grcorsair.com/cert \
  -H "Authorization: Bearer $CORSAIR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "orgId": "org-acme-corp",
    "scope": {
      "name": "SOC 2 Type II - Cloud Platform",
      "frameworks": ["SOC2"],
      "evidencePaths": ["prowler-output.json"]
    },
    "policy": {
      "minimumScore": 80,
      "auditIntervalDays": 90,
      "autoRenew": true,
      "notifyOnChange": true
    }
  }'
```

**Request Body:**

| Field | Type | Required | Description |
|:------|:-----|:---------|:-----------|
| `orgId` | string | Yes | Organization identifier |
| `scope` | object | Yes | Audit scope with `name`, `frameworks[]`, and `evidencePaths[]` |
| `policy` | object | No | Certification policy overrides (minimum score, audit interval, etc.) |

**Policy Defaults:**

| Field | Default | Description |
|:------|:--------|:-----------|
| `minimumScore` | 70 | Minimum passing score |
| `warningThreshold` | 80 | Score below which warnings are issued |
| `auditIntervalDays` | 90 | Days between re-audits |
| `freshnessMaxDays` | 7 | Maximum evidence age |
| `gracePeriodDays` | 14 | Grace period after expiration |
| `autoRenew` | false | Automatically renew on passing re-audit |
| `autoSuspend` | false | Automatically suspend on failing re-audit |
| `notifyOnChange` | false | Send webhook on status change |

**Response (201 Created):**

```json
{
  "ok": true,
  "data": {
    "id": "cert-a1b2c3d4...",
    "orgId": "org-acme-corp",
    "status": "active",
    "currentScore": 91,
    "currentGrade": "A-",
    "lastAuditAt": "2026-02-13T12:00:00.000Z",
    "nextAuditAt": "2026-05-14T12:00:00.000Z",
    "certifiedSince": "2026-02-13T12:00:00.000Z",
    "expiresAt": "2026-05-14T12:00:00.000Z"
  }
}
```

### GET /cert/list

List certifications, optionally filtered by organization and status. Requires authentication.

```bash
# List all certifications
curl https://api.grcorsair.com/cert/list \
  -H "Authorization: Bearer $CORSAIR_API_KEY"

# Filter by organization
curl "https://api.grcorsair.com/cert/list?orgId=org-acme-corp" \
  -H "Authorization: Bearer $CORSAIR_API_KEY"

# Filter by status
curl "https://api.grcorsair.com/cert/list?status=active" \
  -H "Authorization: Bearer $CORSAIR_API_KEY"
```

**Query Parameters:**

| Parameter | Type | Description |
|:----------|:-----|:-----------|
| `orgId` | string | Filter by organization ID |
| `status` | string | Filter by status (`active`, `suspended`, `expired`, `revoked`) |

### GET /cert/status

Check the public status of a certification. No authentication required -- third parties can verify certification validity.

```bash
curl "https://api.grcorsair.com/cert/status?id=cert-a1b2c3d4"
```

**Response:**

```json
{
  "ok": true,
  "data": {
    "id": "cert-a1b2c3d4...",
    "orgId": "org-acme-corp",
    "status": "active",
    "currentScore": 91,
    "currentGrade": "A-",
    "lastAuditAt": "2026-02-13T12:00:00.000Z",
    "nextAuditAt": "2026-05-14T12:00:00.000Z",
    "certifiedSince": "2026-02-13T12:00:00.000Z",
    "expiresAt": "2026-05-14T12:00:00.000Z"
  }
}
```

---

## Third-Party Risk Management (TPRM)

### POST /tprm/vendors

Register a new vendor for risk assessment. Requires authentication.

```bash
curl -X POST https://api.grcorsair.com/tprm/vendors \
  -H "Authorization: Bearer $CORSAIR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Acme Cloud Services",
    "domain": "acme.com",
    "did": "did:web:acme.com",
    "riskTier": "high",
    "tags": ["cloud", "infrastructure", "production"],
    "contacts": [
      { "name": "Jane Doe", "email": "jane@acme.com", "role": "CISO" }
    ]
  }'
```

**Request Body:**

| Field | Type | Required | Description |
|:------|:-----|:---------|:-----------|
| `name` | string | Yes | Vendor display name |
| `domain` | string | Yes | Vendor domain |
| `did` | string | Yes | Vendor's DID (`did:web:...`) |
| `riskTier` | string | Yes | Risk classification: `critical`, `high`, `medium`, `low` |
| `tags` | string[] | Yes | Categorization tags |
| `contacts` | object[] | No | Vendor contacts with `name`, `email`, `role` |

### GET /tprm/vendors

List vendors with optional filters. Requires authentication.

```bash
# List all vendors
curl https://api.grcorsair.com/tprm/vendors \
  -H "Authorization: Bearer $CORSAIR_API_KEY"

# Filter by risk tier
curl "https://api.grcorsair.com/tprm/vendors?riskTier=high" \
  -H "Authorization: Bearer $CORSAIR_API_KEY"

# Filter by tag
curl "https://api.grcorsair.com/tprm/vendors?tag=cloud" \
  -H "Authorization: Bearer $CORSAIR_API_KEY"
```

### POST /tprm/assess

Run a vendor risk assessment against provided CPOEs. Requires authentication. If no `requestId` is provided, an assessment request is created automatically.

```bash
curl -X POST https://api.grcorsair.com/tprm/assess \
  -H "Authorization: Bearer $CORSAIR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "vendorId": "vendor-acme-123",
    "frameworks": ["SOC2", "NIST-800-53"],
    "cpoes": ["eyJhbGciOiJFZERTQSIs..."],
    "minimumScore": 80,
    "minimumAssurance": 1
  }'
```

**Request Body:**

| Field | Type | Required | Description |
|:------|:-----|:---------|:-----------|
| `vendorId` | string | Yes | Vendor to assess |
| `frameworks` | string[] | Yes | Compliance frameworks to evaluate |
| `cpoes` | array | Yes | CPOEs to assess (JWT strings or parsed objects) |
| `requestId` | string | No | Existing assessment request ID |
| `minimumScore` | number | No | Minimum acceptable score (default: 70) |
| `minimumAssurance` | number | No | Minimum assurance level (default: 1) |

### GET /tprm/dashboard

Get the TPRM dashboard summary with vendor counts by risk tier, assessment decisions, and recent activity. Requires authentication.

```bash
curl https://api.grcorsair.com/tprm/dashboard \
  -H "Authorization: Bearer $CORSAIR_API_KEY"
```

**Response:**

```json
{
  "ok": true,
  "data": {
    "totalVendors": 12,
    "byRiskTier": { "critical": 2, "high": 4, "medium": 4, "low": 2 },
    "assessments": {
      "total": 8,
      "approved": 6,
      "conditionallyApproved": 1,
      "rejected": 1
    },
    "averageScore": 84
  }
}
```

---

## Webhooks

Register HTTP endpoints to receive real-time notifications when compliance events occur. All webhook endpoints require authentication.

### POST /webhooks

Register a new webhook endpoint.

```bash
curl -X POST https://api.grcorsair.com/webhooks \
  -H "Authorization: Bearer $CORSAIR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://acme.com/webhooks/corsair",
    "events": ["cpoe.signed", "drift.detected", "score.degraded"],
    "metadata": {
      "environment": "production",
      "orgId": "org-acme-corp"
    }
  }'
```

**Supported Events:**

| Event | Description |
|:------|:-----------|
| `cpoe.signed` | New CPOE issued |
| `cpoe.verified` | CPOE verified by a third party |
| `cpoe.expired` | CPOE reached its `validUntil` date |
| `cpoe.revoked` | CPOE explicitly revoked |
| `score.changed` | Evidence quality score changed |
| `score.degraded` | Score dropped below threshold |
| `drift.detected` | Compliance drift detected |
| `key.rotated` | Signing key was rotated |

**Webhook Payload:**

```json
{
  "id": "evt-a1b2c3d4...",
  "type": "cpoe.signed",
  "timestamp": "2026-02-13T12:00:00.000Z",
  "data": {
    "marqueId": "marque-a1b2c3d4...",
    "scope": "SOC 2 Type II - AWS Production",
    "overallScore": 91
  },
  "apiVersion": "2026-02-01"
}
```

### GET /webhooks

List all active webhook endpoints.

```bash
curl https://api.grcorsair.com/webhooks \
  -H "Authorization: Bearer $CORSAIR_API_KEY"
```

### DELETE /webhooks

Remove a webhook endpoint.

```bash
curl -X DELETE https://api.grcorsair.com/webhooks \
  -H "Authorization: Bearer $CORSAIR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{ "id": "wh-a1b2c3d4..." }'
```

---

## Billing

Manage subscriptions and usage. All billing endpoints require authentication.

### GET /billing

Get subscription and usage details for an organization.

```bash
curl "https://api.grcorsair.com/billing?orgId=org-acme-corp" \
  -H "Authorization: Bearer $CORSAIR_API_KEY"
```

### POST /billing/subscribe

Create a new subscription.

```bash
curl -X POST https://api.grcorsair.com/billing/subscribe \
  -H "Authorization: Bearer $CORSAIR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "orgId": "org-acme-corp",
    "planId": "pro"
  }'
```

### POST /billing/cancel

Cancel a subscription. By default, cancels at the end of the current billing period.

```bash
curl -X POST https://api.grcorsair.com/billing/cancel \
  -H "Authorization: Bearer $CORSAIR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "orgId": "org-acme-corp",
    "atPeriodEnd": true
  }'
```

---

## Discovery Endpoints

These well-known endpoints support CPOE verification, key discovery, and SSF configuration. All are public with no authentication required.

### GET /.well-known/did.json

Returns the DID Document for the Corsair instance, containing the Ed25519 public key used to sign CPOEs. This is the trust anchor for CPOE verification -- any verifier can resolve `did:web:grcorsair.com` to this endpoint.

```bash
curl https://api.grcorsair.com/.well-known/did.json
```

**Response (`application/did+ld+json`):**

```json
{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/suites/jws-2020/v1"
  ],
  "id": "did:web:grcorsair.com",
  "verificationMethod": [{
    "id": "did:web:grcorsair.com#key-1",
    "type": "JsonWebKey2020",
    "controller": "did:web:grcorsair.com",
    "publicKeyJwk": {
      "kty": "OKP",
      "crv": "Ed25519",
      "x": "base64url-encoded-public-key"
    }
  }],
  "authentication": ["did:web:grcorsair.com#key-1"],
  "assertionMethod": ["did:web:grcorsair.com#key-1"]
}
```

Cached for 1 hour (`Cache-Control: public, max-age=3600`).

### GET /.well-known/jwks.json

Returns the JSON Web Key Set containing all active and retired Ed25519 public keys. Retired keys are included for verifying older CPOEs signed before key rotation.

```bash
curl https://api.grcorsair.com/.well-known/jwks.json
```

**Response:**

```json
{
  "keys": [
    {
      "kty": "OKP",
      "crv": "Ed25519",
      "x": "base64url-encoded-public-key",
      "kid": "did:web:grcorsair.com#key-1",
      "use": "sig",
      "alg": "EdDSA"
    }
  ]
}
```

### GET /.well-known/ssf-configuration

Returns SSF (Shared Signals Framework) transmitter metadata per the OpenID SSF specification. Used by FLAGSHIP clients to discover signal delivery configuration.

```bash
curl https://api.grcorsair.com/.well-known/ssf-configuration
```

**Response:**

```json
{
  "issuer": "https://grcorsair.com",
  "jwks_uri": "https://grcorsair.com/.well-known/jwks.json",
  "delivery_methods_supported": [
    "urn:ietf:rfc:8935",
    "urn:ietf:rfc:8936"
  ],
  "configuration_endpoint": "https://api.grcorsair.com/ssf/streams",
  "status_endpoint": "https://api.grcorsair.com/ssf/streams/{stream_id}/status",
  "supported_events": [
    "assurance-level-change",
    "compliance-change",
    "credential-change",
    "session-revoked"
  ]
}
```

---

## Supported Evidence Formats

The `/v1/sign` endpoint auto-detects evidence format from JSON structure. Override with the `format` field.

| Format | Tool | Detection |
|:-------|:-----|:----------|
| `generic` | Any JSON with `{ metadata, controls[] }` | Default fallback |
| `prowler` | AWS Prowler (OCSF) | Array with `StatusCode` + `FindingInfo` |
| `securityhub` | AWS SecurityHub (ASFF) | `{ Findings[] }` |
| `inspec` | Chef InSpec | `{ profiles[].controls[] }` |
| `trivy` | Aqua Trivy | `{ Results[].Vulnerabilities[] }` |
| `gitlab` | GitLab SAST | `{ vulnerabilities[] }` |
| `ciso-assistant-api` | CISO Assistant (API) | `{ results[] }` with compliance fields |
| `ciso-assistant-export` | CISO Assistant (Export) | `{ requirement_assessments[] }` |

---

## SDK

For typed API access, use the Corsair SDK:

```typescript
import { CorsairClient } from "@corsair/sdk";

const corsair = new CorsairClient({
  apiKey: process.env.CORSAIR_API_KEY,
  baseUrl: "https://api.grcorsair.com",
});

// Sign evidence
const { cpoe, summary } = await corsair.sign({
  evidence: prowlerOutput,
  format: "prowler",
  scope: "AWS Production - Q1 2026",
});

// Verify a CPOE (no API key needed)
const verification = await corsair.verify({ cpoe });
console.log(verification.trustTier); // "corsair-verified"
```

See the [SDK documentation](/docs/sdk) for the full typed client reference.

---

## Quick Reference

| Operation | Method | Path | Auth |
|:----------|:-------|:-----|:-----|
| Sign evidence | `POST` | `/v1/sign` | Yes |
| Verify CPOE | `POST` | `/v1/verify` | No |
| Health check | `GET` | `/v1/health` | No |
| Register SCITT entry | `POST` | `/scitt/entries` | Yes |
| Get SCITT entry | `GET` | `/scitt/entries/:id` | No |
| Get SCITT receipt | `GET` | `/scitt/entries/:id/receipt` | No |
| List SCITT entries | `GET` | `/scitt/entries` | No |
| Run audit | `POST` | `/audit` | Yes |
| Create certification | `POST` | `/cert` | Yes |
| List certifications | `GET` | `/cert/list` | Yes |
| Certification status | `GET` | `/cert/status` | No |
| Register vendor | `POST` | `/tprm/vendors` | Yes |
| List vendors | `GET` | `/tprm/vendors` | Yes |
| Assess vendor | `POST` | `/tprm/assess` | Yes |
| TPRM dashboard | `GET` | `/tprm/dashboard` | Yes |
| Register webhook | `POST` | `/webhooks` | Yes |
| List webhooks | `GET` | `/webhooks` | Yes |
| Remove webhook | `DELETE` | `/webhooks` | Yes |
| Get billing | `GET` | `/billing` | Yes |
| Subscribe | `POST` | `/billing/subscribe` | Yes |
| Cancel subscription | `POST` | `/billing/cancel` | Yes |
| DID document | `GET` | `/.well-known/did.json` | No |
| JWKS | `GET` | `/.well-known/jwks.json` | No |
| SSF config | `GET` | `/.well-known/ssf-configuration` | No |
