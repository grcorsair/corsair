---
title: "TypeScript SDK"
description: "Use @corsair/sdk to integrate Corsair signing, verification, and management into your applications."
section: "integrations"
order: 33
---

## Overview

The `@corsair/sdk` package provides a typed TypeScript client for programmatic access to Corsair's signing and verification capabilities. It wraps the core engines into a clean API surface with full type exports.

## Installation

```bash
# Bun (recommended)
bun add @corsair/sdk

# npm
npm install @corsair/sdk
```

## Configuration

```typescript
import { CorsairClient } from "@corsair/sdk";

const corsair = new CorsairClient({
  keyDir: "./keys",                    // Directory for Ed25519 signing keys
  did: "did:web:acme.com",            // Default issuer DID
});
```

Both fields are optional. If `keyDir` is omitted, the client uses the default key location. If `did` is omitted, individual operations can specify it.

| Option | Type | Description |
|--------|------|-------------|
| `keyDir` | `string` | Directory where Ed25519 signing keys are stored |
| `did` | `string` | Default issuer DID (e.g., `"did:web:acme.com"`) |

## Key Generation

Generate an Ed25519 keypair for CPOE signing:

```typescript
const keys = await corsair.keygen("./keys");
console.log(keys.publicKey);   // PEM-encoded public key
console.log(keys.privateKey);  // PEM-encoded private key
```

If no output directory is provided, keys are stored in the configured `keyDir`.

## Sign Evidence

Sign structured evidence as a CPOE (JWT-VC with Ed25519):

```typescript
import { readFileSync } from "fs";

const evidence = JSON.parse(readFileSync("prowler-findings.json", "utf-8"));

const result = await corsair.sign(evidence, {
  format: "prowler",           // Optional: force format (auto-detected by default)
  did: "did:web:acme.com",    // Override issuer DID
  scope: "AWS Production",    // Assessment scope
  expiryDays: 90,             // CPOE validity (default: 90)
  dryRun: false,              // Set true to preview without signing
});

console.log(result.jwt);              // Signed JWT-VC string
console.log(result.marqueId);         // CPOE identifier
console.log(result.detectedFormat);   // "prowler"
console.log(result.summary);          // { controlsTested, controlsPassed, controlsFailed, overallScore }
console.log(result.provenance);       // { source: "tool", sourceIdentity: "prowler" }
console.log(result.warnings);         // Any warnings from parsing
console.log(result.extensions);       // Optional passthrough fields + mapping metadata
```

### SignOptions

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `format` | `EvidenceFormat` | auto-detect | Force evidence format |
| `did` | `string` | config default | Override issuer DID |
| `scope` | `string` | from evidence | Override scope string |
| `expiryDays` | `number` | `90` | CPOE validity in days |
| `dryRun` | `boolean` | `false` | Parse without signing |

### Supported Formats

Call `corsair.formats()` to get the full list:

```typescript
const formats = corsair.formats();
// ["generic", "prowler", "securityhub", "inspec", "trivy", "gitlab", "ciso-assistant-api", "ciso-assistant-export"]
```

For tool outputs not on the built-in list, use the mapping registry on the signing host (see `CORSAIR_MAPPING_DIR` / `CORSAIR_MAPPING_FILE`). Evidence-only mappings still produce a valid CPOE and surface passthrough fields under `extensions`. Mappings are evaluated by priority (higher wins), then filename order.

## Verify CPOEs

Verify a CPOE signature and structure:

```typescript
const result = await corsair.verify(jwtString);

if (result.valid) {
  console.log("Issuer:", result.signedBy);
  console.log("Trust tier:", result.issuerTier);   // "corsair-verified" | "self-signed" | "unverifiable" | "invalid"
  console.log("Scope:", result.scope);
  console.log("Score:", result.summary?.overallScore);
  console.log("Provenance:", result.provenance?.source);
  console.log("Expires:", result.expiresAt);
} else {
  console.log("Invalid:", result.reason);
  // "signature_invalid" | "expired" | "schema_invalid" | "evidence_mismatch"
}
```

### VerifyResult

| Field | Type | Description |
|-------|------|-------------|
| `valid` | `boolean` | Whether the CPOE passed verification |
| `reason` | `string` | Failure reason (only when invalid) |
| `signedBy` | `string` | Issuer DID |
| `issuerTier` | `string` | Trust tier: `corsair-verified`, `self-signed`, `unverifiable`, `invalid` |
| `scope` | `string` | Assessment scope |
| `summary` | `object` | Controls tested/passed/failed and overall score |
| `provenance` | `object` | Source, identity, and date |
| `generatedAt` | `string` | Issuance timestamp |
| `expiresAt` | `string` | Expiry timestamp |
| `extensions` | `object` | Optional passthrough fields and mapping metadata |

## TypeScript Types

All types are exported from the package for type-safe integration:

```typescript
import type {
  // SDK types
  CorsairClientConfig,
  SignOptions,
  SignResult,
  VerifyResult,

  // Evidence format
  EvidenceFormat,


  // Canonical evidence types
  CanonicalControlEvidence,
  CanonicalStatus,       // "pass" | "fail" | "skip" | "error"
  CanonicalSeverity,     // "critical" | "high" | "medium" | "low" | "info"
  EvidenceType,          // "config" | "scan" | "test" | "observation" | "attestation" | "document"
  ProvenanceSource,      // "self" | "tool" | "auditor"
  NormalizedEvidence,

  // Verification types
  MarqueVerificationResult,
} from "@corsair/sdk";
```

## Complete Example

End-to-end workflow: generate keys, sign evidence, and verify the output:

```typescript
import { CorsairClient } from "@corsair/sdk";
import { readFileSync } from "fs";

// Initialize
const corsair = new CorsairClient({ keyDir: "./keys", did: "did:web:acme.com" });

// Generate keys (first time only)
await corsair.keygen();

// Load evidence
const evidence = JSON.parse(readFileSync("prowler-findings.json", "utf-8"));

// Sign
const signed = await corsair.sign(evidence, { format: "prowler", scope: "AWS Production" });
console.log(`Signed CPOE: ${signed.marqueId} (${signed.summary.overallScore}/100)`);

// Verify the signed CPOE
const verification = await corsair.verify(signed.jwt);
console.log(`Valid: ${verification.valid}, Tier: ${verification.issuerTier}`);
```
