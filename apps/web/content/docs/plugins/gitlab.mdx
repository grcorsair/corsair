---
title: "GitLab"
description: "Branch protection, merge request approval, secret detection, and pipeline security tests for GitLab projects."
section: "plugins"
order: 25
---

## Overview

The GitLab plugin tests source code management security — branch protection rules, merge request approval policies, secret detection pipeline configuration, and CI/CD pipeline security.

## Attack Vectors

### Unprotected Default Branch (`unprotected-default-branch`)

**Severity:** CRITICAL
**MITRE ATT&CK:** T1195.002 (Supply Chain: Compromise Software Supply Chain)

Checks whether the default branch (usually `main` or `master`) has branch protection rules enforced — required approvals, push restrictions, and force push prevention.

### Missing Merge Request Approvals (`missing-mr-approvals`)

**Severity:** HIGH
**MITRE ATT&CK:** T1195.002 (Supply Chain: Compromise Software Supply Chain)

Verifies that merge requests require at least one approval before merging. Single-person merge capability bypasses code review controls.

### No Secret Detection (`no-secret-detection`)

**Severity:** HIGH
**MITRE ATT&CK:** T1552 (Unsecured Credentials)

Checks whether the GitLab project has secret detection enabled in its CI/CD pipeline to catch accidentally committed credentials, API keys, and tokens.

### Pipeline Security Gaps (`pipeline-security-gaps`)

**Severity:** MEDIUM
**MITRE ATT&CK:** T1059 (Command and Scripting Interpreter)

Analyzes the CI/CD pipeline configuration for security gaps — unprotected variables, use of `allow_failure` on security jobs, and pipeline execution on unprotected branches.

## Usage

```bash
# Demo mode
bun corsair.ts --target demo --service gitlab

# Live mode (requires GITLAB_TOKEN)
export GITLAB_TOKEN=glpat-xxxxxxxxxxxx
bun corsair.ts --target my-project-id --service gitlab
```

## Required Permissions

GitLab Personal Access Token with:
```
read_api
read_repository
```
